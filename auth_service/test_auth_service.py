"""
Below is the full Python implementation of a user authentication system, which consists of two modules:
  - `User` class (user.py): Handles user attributes, authentication states, and session management.
  - `AuthService` class (auth_service.py): Manages user registration, login, password security, and rate limiting.

I want you to write unit tests and integration tests for the methods in `User` class and `AuthService` class:

Your tests must:
- Provide **separate unit tests** for each method listed above.
- Provide **integration tests** that show how these methods work together in realistic authentication scenarios.
- Achieve high coverage.
- Include a brief comment or docstring in each test (or group of tests) indicating which coverage type(s) it addresses.

Return your test code in a SINGLE code block, including all necessary imports (like `unittest`),
so it's ready to run.

=================== COPY THE ENTIRE CODE BELOW ===================
# user.py
<INSERT THE ENTIRE CONTENTS OF 'user.py' HERE>

# auth_service.py
<INSERT THE ENTIRE CONTENTS OF 'auth_service.py' HERE>
==================================================================
"""